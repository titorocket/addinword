/*! For license information please see c0ae34422ed02a3a2cd2.js.LICENSE.txt */
function _regenerator(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var s=r&&r.prototype instanceof i?r:i,d=Object.create(s.prototype);return _regeneratorDefine2(d,"_invoke",function(n,r,o){var a,i,s,d=0,l=o||[],u=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,i=0,s=e,f.n=n,c}};function p(n,r){for(i=n,s=r,t=0;!u&&d&&!o&&t<l.length;t++){var o,a=l[t],p=f.p,g=a[2];n>3?(o=g===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<g&&(o=n<3||a[0]>r||r>g)&&(a[4]=n,a[5]=r,f.n=g,i=0))}if(o||n>1)return c;throw u=!0,r}return function(o,l,g){if(d>1)throw TypeError("Generator is already running");for(u&&1===l&&p(l,g),i=l,s=g;(t=i<2?e:s)||!u;){a||(i?i<3?(i>1&&(f.n=-1),p(i,s)):f.n=s:f.v=s);try{if(d=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(u=f.n<0)?s:n.call(r,f))!==c)break}catch(t){a=e,i=1,s=t}finally{d=1}}return{value:t,done:u}}}(n,o,a),!0),d}var c={};function i(){}function s(){}function d(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(_regeneratorDefine2(t={},r,function(){return this}),t),u=d.prototype=i.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return s.prototype=d,_regeneratorDefine2(u,"constructor",d),_regeneratorDefine2(d,"constructor",s),s.displayName="GeneratorFunction",_regeneratorDefine2(d,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,r,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:a,m:f}})()}function _regeneratorDefine2(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_regeneratorDefine2=function(e,t,n,r){function a(t,n){_regeneratorDefine2(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},_regeneratorDefine2(e,t,n,r)}function asyncGeneratorStep(e,t,n,r,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){asyncGeneratorStep(a,r,o,c,i,"next",e)}function i(e){asyncGeneratorStep(a,r,o,c,i,"throw",e)}c(void 0)})}}var pdfTextContent="",currentFontSize=14;function initializeEventListeners(){document.getElementById("pdf-file").addEventListener("change",handlePdfUpload),document.getElementById("select-file-btn").addEventListener("click",function(){document.getElementById("pdf-file").click()}),document.getElementById("search-button").addEventListener("click",searchAndInsertArticle),document.getElementById("insert-selection-button").addEventListener("click",insertSelectedText),document.getElementById("zoom-in").addEventListener("click",function(){return adjustFontSize(2)}),document.getElementById("zoom-out").addEventListener("click",function(){return adjustFontSize(-2)}),document.getElementById("search-term").addEventListener("keypress",function(e){"Enter"===e.key&&searchAndInsertArticle()})}function setupDragAndDrop(){var e=document.getElementById("upload-area");["dragenter","dragover","dragleave","drop"].forEach(function(t){e.addEventListener(t,preventDefaults,!1)}),["dragenter","dragover"].forEach(function(t){e.addEventListener(t,highlight,!1)}),["dragleave","drop"].forEach(function(t){e.addEventListener(t,unhighlight,!1)}),e.addEventListener("drop",handleDrop,!1)}function preventDefaults(e){e.preventDefault(),e.stopPropagation()}function highlight(e){document.getElementById("upload-area").classList.add("drag-over")}function unhighlight(e){document.getElementById("upload-area").classList.remove("drag-over")}function handleDrop(e){var t=e.dataTransfer.files;if(t.length>0){var n=t[0];if("application/pdf"===n.type){var r=document.getElementById("pdf-file"),o=new DataTransfer;o.items.add(n),r.files=o.files,handlePdfUpload({target:{files:[n]}})}else showMessage("Por favor, selecciona un archivo PDF válido.","error")}}function handlePdfUpload(e){var t=e.target.files[0];if(t&&"application/pdf"===t.type)if(t.size>10485760)showMessage("El archivo es demasiado grande. Máximo 10MB permitido.","error");else{var n=new FileReader,r=document.getElementById("loading-spinner"),o=document.getElementById("main-controls"),a=document.getElementById("upload-step");r.style.display="block",o.style.display="none",a.style.display="none",pdfTextContent="",n.onload=function(){var e=new Uint8Array(this.result);pdfjsLib.getDocument(e).promise.then(function(e){var n=[],r=e.numPages;updateDocumentInfo(t.name,r);for(var o=1;o<=e.numPages;o++)n.push(e.getPage(o).then(function(e){return e.getTextContent()}));return Promise.all(n)}).then(function(e){pdfTextContent=e.map(function(e,t){var n=e.items.map(function(e){return e.str}).join(" ");return"=== PÁGINA ".concat(t+1," ===\n").concat(n)}).join("\n\n"),renderPdfAsText(e),r.style.display="none",o.style.display="block",showMessage("Documento cargado y procesado correctamente.","success")}).catch(function(e){console.error("Error al procesar el PDF:",e),r.style.display="none",a.style.display="block",showMessage("Error al procesar el PDF. Verifica que el archivo no esté dañado.","error")})},n.readAsArrayBuffer(t)}else showMessage("Por favor, selecciona un archivo PDF válido.","error")}function updateDocumentInfo(e,t){document.getElementById("document-name").textContent=e,document.getElementById("document-stats").textContent="".concat(t," página").concat(1!==t?"s":""," • Procesado correctamente")}function renderPdfAsText(e){var t=document.getElementById("pdf-viewer");t.innerHTML="",e.forEach(function(e,n){if(n>0){var r=document.createElement("div");r.style.cssText="\n                border-top: 2px solid var(--border-color);\n                margin: 20px 0;\n                padding-top: 15px;\n                font-weight: 600;\n                color: var(--neutral-secondary);\n                font-size: 12px;\n            ",r.textContent="--- PÁGINA ".concat(n+1," ---"),t.appendChild(r)}var o=document.createElement("div");o.style.cssText="\n            margin-bottom: 20px;\n            padding: 15px;\n            background: ".concat(n%2==0?"#fafafa":"#ffffff",";\n            border-radius: 4px;\n            border-left: 3px solid var(--primary-color);\n            user-select: text;\n            cursor: text;\n        ");var a=e.items.map(function(e){return e.str}).join(" ");o.textContent=a,highlightArticles(o),t.appendChild(o)}),t.style.fontSize=currentFontSize+"px"}function highlightArticles(e){var t=e.textContent,n=t.match(/((?:Artículo|Articulo|Art\.)\s+\d+[^\n]*)/gi);if(n){var r=t;n.forEach(function(e){r=r.replace(e,'<mark style="background: #fff3cd; padding: 2px 4px; border-radius: 3px; font-weight: 600;">'.concat(e,"</mark>"))}),e.innerHTML=r}}function adjustFontSize(e){currentFontSize=Math.max(10,Math.min(24,currentFontSize+e)),document.getElementById("pdf-viewer").style.fontSize=currentFontSize+"px",showMessage("Tamaño de fuente: ".concat(currentFontSize,"px"),"info",1500)}function searchAndInsertArticle(){var e=document.getElementById("search-term").value.trim(),t=document.getElementById("search-result");if(pdfTextContent)if(e){t.textContent="",showMessage("Buscando artículo...","info");for(var n=null,r=0,o=["(?:Artículo|Articulo|Art\\.)\\s+".concat(e,"(?:\\s|\\.|:)[\\s\\S]*?(?=(?:Artículo|Articulo|Art\\.)\\s+\\d|CAPÍTULO|TÍTULO|===|$)"),"Art\\s+".concat(e,"[\\s\\S]*?(?=Art\\s+\\d|CAPÍTULO|TÍTULO|===|$)"),"".concat(e,"\\.[\\s\\S]*?(?=\\d+\\.|CAPÍTULO|TÍTULO|===|$)")];r<o.length;r++){var a=new RegExp(o[r],"i"),c=pdfTextContent.match(a);if(c&&c[0]){n=c[0].trim();break}}n?(n=cleanExtractedText(n),showMessage("✅ Artículo ".concat(e," encontrado e insertado correctamente."),"success"),insertTextIntoWord(n),highlightSearchResult(e)):showMessage('❌ Artículo "'.concat(e,'" no encontrado. Verifica el número e intenta de nuevo.'),"error")}else showMessage("Por favor, ingresa un número de artículo.","error");else showMessage("Primero debes cargar un PDF.","error")}function cleanExtractedText(e){return e.replace(/===[^===]*===/g,"").replace(/\s+/g," ").replace(/^\s+|\s+$/g,"").replace(/([.!?])\s*([A-ZÁÉÍÓÚÑ])/g,"$1\n\n$2")}function highlightSearchResult(e){var t=document.getElementById("pdf-viewer"),n=new RegExp("((?:Artículo|Articulo|Art\\.)\\s+".concat(e,"[^\\n]*)"),"gi"),r=t.innerHTML.replace(n,'<span style="background: #ffeb3b; padding: 3px 6px; border-radius: 4px; font-weight: bold; animation: pulse 2s;">$1</span>');t.innerHTML=r;var o=t.querySelector('span[style*="ffeb3b"]');o&&o.scrollIntoView({behavior:"smooth",block:"center"})}function insertSelectedText(){var e=window.getSelection().toString().trim();e?(e.length<10&&showMessage("⚠️ El texto seleccionado es muy corto. ¿Estás seguro de que es correcto?","warning"),insertTextIntoWord(cleanExtractedText(e)),showMessage("✅ Texto seleccionado insertado correctamente (".concat(e.length," caracteres)."),"success"),window.getSelection().removeAllRanges()):showMessage("❌ Por favor, selecciona primero un fragmento de texto de la vista previa.","error")}function insertTextIntoWord(e){Word.run(function(){var t=_asyncToGenerator(_regenerator().m(function t(n){var r,o,a;return _regenerator().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,r=n.document.getSelection(),(o=r.insertText(e+"\n\n",Word.InsertLocation.end)).font.name="Calibri",o.font.size=11,o.paragraphFormat.spaceAfter=6,t.n=1,n.sync();case 1:showMessage("✅ Texto insertado correctamente en el documento.","success"),t.n=3;break;case 2:t.p=2,a=t.v,console.error("Error al insertar texto:",a),showMessage("❌ Error al insertar texto. Verifica que Word esté disponible.","error");case 3:return t.a(2)}},t,null,[[0,2]])}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){console.error("Error en Word.run:",e),showMessage("❌ Error de conexión con Word.","error")})}function showMessage(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3,r=document.getElementById("search-result");r.className="result-message",r.classList.add(t),r.textContent=e,n>0&&setTimeout(function(){r.textContent="",r.className="result-message"},n)}Office.onReady(function(e){e.host===Office.HostType.Word&&(initializeEventListeners(),setupDragAndDrop())});var style=document.createElement("style");style.textContent="\n    @keyframes pulse {\n        0% { transform: scale(1); }\n        50% { transform: scale(1.05); }\n        100% { transform: scale(1); }\n    }\n",document.head.appendChild(style),document.addEventListener("keydown",function(e){(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&document.getElementById("search-term")===document.activeElement&&searchAndInsertArticle(),(e.ctrlKey||e.metaKey)&&"i"===e.key&&(e.preventDefault(),insertSelectedText()),(e.ctrlKey||e.metaKey)&&"+"===e.key&&(e.preventDefault(),adjustFontSize(2)),(e.ctrlKey||e.metaKey)&&"-"===e.key&&(e.preventDefault(),adjustFontSize(-2))}),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("button").forEach(function(e){if(!e.title&&e.textContent){var t=e.textContent.trim();t.includes("Buscar")?e.title="Buscar artículo e insertar en el documento (Ctrl+Enter)":t.includes("Insertar")&&(e.title="Insertar texto seleccionado (Ctrl+I)")}});var e=document.querySelector(".footer-text");e&&(e.innerHTML+=' • <span title="Ctrl+Enter: Buscar, Ctrl+I: Insertar, Ctrl++/-: Zoom">Atajos disponibles</span>')});